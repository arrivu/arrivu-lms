<%
   js_bundle :course_comments,:bootstrap
   js_env :review_course_id =>  @context.id
   @body_classes << "gradebook2 full-width"
   @show_left_side = false
   jammit_css :course_library ,:bootstrap_and_responsive
%>
<% if @context.settings[:allow_user_to_design_course_detail_page] %>
    <% if @context.static_content %>
     <%= @context.static_content.page_desc.html_safe %>
    <% end %>
<% else %>
<div class="row-fluid"
<% if @context_bg_image_url %>
    style="background-image: url('<%= @context_bg_image_url %>');background-size: 100% 100%;min-height: 235px;"
<% else  %>
    style="background: #f6f5ed;
            box-shadow: 0 1px 2px rgba(0,0,0,0.2);"
<% end  %>
>
  <div class="span3" style="text-align:center;padding: 20px;">
    <% if @context_image_url  %>
        <%= image_tag @context_image_url %>
    <% else %>
        <div style="width: 280px;height: 207px;"></div>
    <% end %>
  </div>
<div class="span6" style="padding: 1%;">
  <div style="font-size: 23px;
          font-weight: bold;">
        <%= @context.name %>
  </div>

  <div style="font-size: 16px;">
    <br/>
    <p>
     <%= @context.course_description.try(:short_description) %>
    </p>
  </div>

  <div style="margin-top: 53px;word-wrap:break-word;">
    <ul class="">
      <li class="course_properties">
       <%= image_tag 'comments.png',:style=>"margin-top: -2px;" %>  <%= pluralize(@context.comments.size,"Review") %>
      </li>
      <li class="course_properties">
        <%= image_tag 'modules.png',:style=>"margin-top: -2px;" %>  <%= pluralize(@context.context_modules.size,"Module") %>
      </li>
      <li class="course_properties">
        <%= image_tag 'people.png',:style=>"margin-top: -2px;" %> <%= pluralize(@context.students.size,"Student") %> Enrolled
      </li>
    </ul>
 
  </div>

</div>

 
  <div class="span3" style="text-align: center;margin-top: 25px;
border: 1px solid hsl(0, 0%, 87%);border-radius: 4px;padding: 25px;background: #fff;">
    <div style="font-size: 18px;">Cost per enrollment:</div>
    <div style="font-size: 18px;margin-top: 10px;font-weight: bold;
            color: darkgreen;">
      <%unless @course_pricing.nil? %>
      &#8377;
      <% end  %>
      <%= @course_pricing.nil? ? "Free" : " #{Money.new(@course_pricing.price.to_i, "INR")}" %></div>
    <div style="margin-top: 20px;">
     <%if can_do(@context, @current_user, :read)  %>
          <%= link_to "Go to class" ,course_path(@context) ,:class =>"btn btn-primary btn-large" ,:style=> "border-radius: 0px;"%>
     <% else  %>
          <button class="btn btn-primary btn-large element_toggler" aria-controls="enrollment_dialog"  type="button" style="border-radius: 0px;">Take This Course</button>
     <% end  %>
    </div>
  </div>
</div>

<div class="">
  <div class="span3">
    <h1 style="font-size: 1.8em;font-weight: normal;">Instructors</h1>
    <% @context.teachers.each do |teacher| %>
        <a href="<%= user_details_path(teacher) %>" style="text-decoration: none;color: black">
    <div class="instructor-bio comment comment_box" style="max-height: none;border-bottom: 1px solid lightgray;border-right: 1px solid lightgray;
            border-radius: 4px;">
      <img src=<%= teacher.avatar_url ? teacher.avatar_url : "http://www.gravatar.com/avatar/00000000000000000000000000000000?d=mm&f=y" %> width="100" height="100" class="left img-circle" alt="<%= teacher.name%>">
      <h3 class="last emboss-light" style="font-size: 1.5em;font-weight: normal;word-break: break-all;line-height: 17px;">&nbsp&nbsp<%= teacher.name%></h3>
      <p class="fineprint emboss-light"><em class="small-head" style="margin-left: 10px;"><%= teacher.profile.title if  teacher.profile %></em></p>
        <div class="more">
            <%= teacher.profile.bio if  teacher.profile %>
        </div>
      <!--<div class="instructor-bio-more" style="display: none;">-->
        <!--<a href="#" class="prompt-link">More</a>-->
      <!--</div>-->
    </div>
        </a>
        <br/>
    <% end %>

  </div>


    <div class="span7">
    <h1 style="border-bottom: 1px solid lightgray;font-size: 1.8em;font-weight: normal;" >Full course description</h1>
      <div class="small">
       <p> <%= @context.course_description.try(:long_description) %></p>
      </div>
      <hr/>

      <h1 style="font-size: 1.8em;font-weight: normal;">Course Modules</h1>
      <ul style="margin: 0px;">
        <% @context.context_modules.active.each_with_index do |context_modules, idx |  %>
        <li class="course_module_item <%= idx == 0 ? 'default_hover_style' : "" %> ">
          <%= context_modules.name %>
        </li>
        <% end  %>
      </ul>
    </div>

<% if @comments.count>0 %>
<div class="span3">
    <h1 style="font-size: 1.8em;font-weight: normal;">Reviews</h1>
    <% @comments.each do |comment| %>
      <a href="<%= user_details_path(comment.user) %>" style="text-decoration: none;color: black">
          <div  class="comment left_bottom_border" id="comment_<%= comment ? comment.id : "{{ blank }}" %>" style="<%= hidden unless comment %>">
            <div style="float: left;margin-bottom: 5px;" class="user_name">

              <% if service_enabled?(:avatars) %>
                  <img class="img img-circle" src=<%=  comment.user.avatar_url ?  comment.user.avatar_url: "http://www.gravatar.com/avatar/00000000000000000000000000000000?d=mm&f=y" %> width="50px" height="50px" alt="<%= comment.user.name%>">
              <% end  %>
              <%= comment.user_name rescue nbsp %></div>
            &nbsp;<%= comment.user.name  %>
            <br> &nbsp;

            <span class="created_at" style="color: #888; font-size: 0.8em;">
                  <%= datetime_string(comment.updated_at) rescue nbsp %></span>
            <div class="clear" style="border-top: 1px solid #ccc;"></div>
           <p><%= comment.comment  %></p>
          </div>
        </a>
    <%end %>
     <% @total_count =   @context.comments.approved.count%>
    <a class="btn btn-primary" id="comments_review" style="margin-left: 20%;border-radius: 0px;margin-bottom: 10px;">
      SEE ALL <%= @total_count%> REVIEWS </a>
  </div></div>
<%end %>

<form action="<%=library_enrollments_path(@context)%>" id="enrollment_dialog" data-turn-into-dialog='{"width":600,"height":600,"modal":true}' style="display:none"
      title="<%= @context.name %>">
  <p> You are enrolling in,<b><%= @context.name %> </b> as a student.</p>
  <br/>
  <div class="price_box_on_model thumbnail">
    <div style="font-size: 18px;margin-top: 10px;">Cost per enrollment:</div>
    <div style="font-size: 18px;margin-top: 10px;font-weight: bold;
            color: darkgreen;"><%= @course_pricing.nil? ? "Free" : "$#{@course_pricing.price}" %></div>
  </div>
  <br/>
  <% if @current_user %>
    <p>You are currently signed in as <b><%= @current_user.name %></b>. </p>
   <% else  %>
      <p>Please enter your email address:</p>
   <div id="login_url" style="margin-left: 128px;" rel="<%= login_path(:nonldap => (@domain_root_account && !@domain_root_account.ldap_authentication?).presence) %>">
        <div class="control-group" id="email_info" rel="<%= library_create_user_path(@context) %>">
          <label class="control-label" for="student_email">Email</label>
          <div class="controls">
            <input type="email" id="student_email" name="pseudonym[unique_id]" required="required" >
          </div>
        </div>
        <div class="control-group" id="initial_action">
          <div class="controls">
            <label class="radio">
              <input type="radio" name="initial_action" value="create">
              I am a new user
            </label>
            <label class="radio">
              <input type="radio" name="initial_action" value="log_in">
              I already have a <%=@domain_root_account.name  %> login
            </label>
          </div>
        </div>
        <div class="user_info" id="log_in_user_info" style="display: none;">
          <div class="control-group">
            <label class="control-label" for="student_password">Password</label>
            <div class="controls">
              <input type="password" id="student_password" name="pseudonym[password]" required="required">
            </div>
          </div>
        </div>
        <div class="user_info" id="create_user_info" style="display: none;">
          <div class="control-group">
            <label class="control-label" for="student_name">Full Name</label>
            <div class="controls">
              <input type="text" id="student_name" name="user[name]" required="required">
            </div>
          </div>
          <div class="control-group">
            <div class="controls">
              <label class="checkbox">
                <input id="terms_of_use" type="checkbox" name="user[terms_of_use]" value="1" required="required" >
                You agree to the <a href="<%= @domain_root_account.terms_of_use_url %>" target="_blank" class="external"><span>terms of use</span><span class="ui-icon ui-icon-extlink ui-icon-inline" title="Links to an external site."></span></a> and the <a href="//www.arrivulms.com/code-of-conduct" target="_new">code of conduct</a>.
              </label>
            </div>
          </div>
        </div>
        <div class="control-group embedded-footer">
          <a href="<%= @domain_root_account.privacy_policy_url %>" target="_blank" class="footer-info external"><span>View Privacy Policy</span><span class="ui-icon ui-icon-extlink ui-icon-inline" title="Links to an external site."></span></a>
          <div class="controls">
            <button class="btn btn-primary" style="visibility: hidden" id="submit_button" type="submit">Next</button>
          </div>
        </div>
    </div>
  <% end %>
  <div class="button-container">
    <% if @current_user %>
    <button type="submit" id="course_enrollment" class="btn btn-primary">Enroll in course</button>
    <% end %>
    <a class="btn dialog_closer">cancel</a>
  </div>
</form>
<% end %>